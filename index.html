<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>ECE3140 / CS3420 Final Project Page by ece3140-sp2023</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">ECE3140 Final Project Page</h1>
      <h3 class="project-name">Hear the Colors!</h3>
      <h4 class="project-tagline">Canwen Zhang (cz236), Cheng Tang (ct628)</h4>
      
      <a href="https://github.coecis.cornell.edu/ece3140-sp2023/base-page" class="btn">View base-page on GitHub</a>
    </section>

<section class="main-content">
 
<!-- <h3>Welcome to your ECE3140 / CS 3420 GitHub Page!</h3>
<p>This branch of the project is set up as a basic project web-page for you to edit.</p> 
<p>You should update (and remove) this text.</p>  
<p>You can edit this file direclty or use any other method to update/generate your page. In order to update the material, 
    push to the "gh-pages" branch. Also note, that while the repo is private the <strong>page content is public</strong>.</p>
<hr> -->

<h3>System Overview</h3> 
<p>For our project “Hear the Colors!”, the main goal is to design a machine that could transform color into sound, so that we can compose a song using different colors.
<p>To implement this project, we will mainly use a color sensor and a buzzer in addition to our FRDM-KL46Z board. One way to interact with this machine is to first prepare different colors on a long piece of paper, then insert this paper into our machine box (which has the color sensor in it) and slowly pull the one end of that piece of paper through the box. Then as the paper is pulled through and the color on it is scanned by the color sensor, the sensor will send the RGB data corresponding to that color back to the board and our buzzer could then generate sound with different frequencies based on the color. Through some careful arrangement of the colors, we could even play some famous songs using the machine.</p>

<p>For peripherals we plan to use the TCS3200 color sensor and a common piezo buzzer. In terms of the hardware, the TCS3200 color sensor reads color by using a 8x8 photodiode array, then it uses the current-to-frequency converter to output a square wave whose frequency is related to  light intensity of that color. It can do this procedure for all three primary colors red, green, and blue, so by comparing the ratio between RGB readings we would be able to distinguish more than 3 colors. This is simply because all the colors can be obtained by mixing RGB colors with a different ratio. Another reason for choosing this sensor is that TCS3200 takes digital inputs and outputs, so we believe it should not be too hard to interface it with a microcontroller like our ARM Cortex M0 processor. After we read the data and determine the frequency wanted, we send a signal in PWM to the piezo buzzer. The buzzer part might sound easy, but it requires us to change the frequency of the PWM signal which might require some more work than if we were to achieve the same thing on a platform like Arduino (although the idea behind should be similar). On the software side, the overall general structure is to write a forever running loop where inside we keep reading the RGB data from the digital pin of the board and compare its values with a certain defined threshold. But once the RGB data exceeds that threshold which means the sensor has detected a color, an interrupt should be generated which should transfer the control to our ISR. Next, in the ISR it quickly compares that RGB data with some ranges we pre-defined to figure out the color and sends the corresponding PWM signal to the piezo buzzer. This way we are able to distinguish colors and play different sounds based on the colors.</p>

<h4>Current Progress</h4>
  
<p>Compared to last time, we obtained a more detailed understanding of our TCS3200 sensor. As mentioned above, the sensor transmits color information by outputting 50% duty cycle square waves of different frequencies (i.e. it sets a digital pin high/low at different speeds depending on the color). Therefore, by using polling to continuously check the state of the OUT pin and enable/disable the PIT timer when the OUT state changes, we are able to calculate the period (1/frequency) of the square wave. In this way, we only need to monitor the state of a pin over time and do not have to employ any communication protocol such as serial to talk to our sensor. One thing to note is that, because the color could change anytime which means we cannot predict when the frequency of the square wave will change, we need to keep calculating the period and remember to reset our PIT timer after every round of recording.</p>

<br><br>
<p>As we are trying to interface the sensor, one slight difficulty is that, instead of reading all three RGB data at one time, our sensor is only able to read one of the colors at a time. This means we need to repeat the above procedure three times in order to collect the complete RGB information for a given color. That is, we have to constantly set and clear pins S2 and S3 in order to change the color filter so that we could switch to reading a different color. This can be achieved through a conditional for-loop that keeps going through the three colors and sets up the filter accordingly. For the frequency scaling factor (controlled by S0 and S1), we decide to set the to 20% for now (S0=1, S1=0) which gives us an intermediate frequency range and also an intermediate accuracy (tradeoff between detection range and accuracy). </p>

<br><br>
<p>On the hardware side, we have soldered the header pin socket to the board so that we could be more flexible in case we want to switch pins halfway through the project. For wiring, we selected PTD2(D9), PTD4(D10), PTD6(D11), PTD7(D12), PTD3(D2) to be connected with S0, S1, S2, S3, and OUT on TCS3200 color sensor, respectively. We choose those pins because they seem to be pure GPIO pins and do not have any extra default functionality or “strange” setting that might interfere with our basic reading/writing operation.</p>

<br><br>
<p>Finally, we have just started on the buzzer side of the project which might require us to use a PWM signal. So we decided to use PTC8 (D6) pin on the board to control it since it is also a PWM pin. We have looked into some SDK examples on MCUxpresso about PWM and will continue to work on it during the following days.</p>
  
  
<h3>Web Check-In</h3>

<p>Please remove this page and write a short paragraph on your progress to date and make a draft for the System Overview 
    section. Are there any major obstacles?</p>
<p>You can also start putting in the structure for the final page, but we will only be looking at the System Overview 
     for now. Your project page should have the following sections (which are similar to the lab reports).</p>
 
 
<ul>
<li>A Descriptive Project Name</li>
<li>Introduction</li>
<li>System Overview &lt;--- Draft for Web Check In</li>
<li>Project Video Demo (~3-4min)</li>
<li>Detailed Technical Description</li>
<li>Additional Resources Used</li>
<li>Work Distribution (skip if you work by yourself)</li>
</ul>

<hr>
<h3> Section Details </h3> 
Here is a more detailed breakdown of what the different sections should have. 
<h4>Introduction</h4>
<ol>
<li>Motivation of your project. If appropriate, consider the impact of your system public health, safety, and 
  welfare as well as relevant global, cultural, social, environmental, and economic factors.</li>
<li>Describes briefly what their system does.</li>
<li>Include any necessary background information.</li>
<li>Summary of what you have accomplished and what you have learned.</li>
</ol>

<h4> System Overview and diagram </h4>
Give a high-level description of how the system works and how the different parts work together. 
Include a block diagram of the system showing how components interact. This diagram could potentially be replaced by very clear writing. (You don't need the diagram for the web check-in).
      
<h4>Video</h4> 
The video should have the right length (3-4 min, if shorter than 2 min or longer than 5 mins, we will deduct points) 
The video should be self-contained, i.e. understandable by someone who has not read your whole website.
<ol>
<li> Give a brief overview of the project. </li>
<li> Show the system working. </li>
<li> Describe some of the technical details. </li>
</ol> 

<ul>
<li> What would be the most interesting piece of information for your fellow students? </li>
<li> Was there a super tricky bug? </li>
<li> Something surprising you learned during the implementation? </li>
<li> Did you come up with some super clever tests? </li>
</ul>
      
<h4> Technical description </h4>
<ol>
<li> Explains how their system/software works. </li>
<li> Should be at an appropriate level of detail to allow you to evaluate their design decisions. </li>
<li> Projects with additional hardware must include a schematic. </li>
</ol>
      
<h4> Testing </h4>
<ol>
<li> Describes their testing procedure and how they determined the system works correctly. </li>
<li> Some projects may not have traditional test cases (e.g. tested the system by human interaction with it), but all projects must be tested. </li>
</ol>
<h4> Work Distribution </h4>
Talk about how you split up the work and made sure that everyone contributed. 
      
      
</section>

  
</body>
</html>
